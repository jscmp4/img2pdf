(this["webpackJsonppdf-app"]=this["webpackJsonppdf-app"]||[]).push([[0],{49:function(e,t,i){},50:function(e,t,i){},61:function(e,t,i){"use strict";i.r(t);var a=i(14),s=i.n(a),n=i(27),l=i.n(n),r=(i(49),i(50),i(11)),o=i(19),c=i.n(o),d=i(43),g=i(44),p=i(5);Object(d.polyfill)({dragImageTranslateOverride:g.scrollBehaviourDragImageTranslateOverride}),window.addEventListener("touchmove",(function(){}));const h="A4",x="US Letter",f="Same as Image",u="Portrait",j="Landscape",b="0",y="20",m="50";class O extends s.a.Component{constructor(e){super(e),this.clearSelection=()=>{let e=[...this.state.images];e.forEach((e=>{e.selected=!1})),this.setState({images:e})},this.readfiles=async e=>{console.log(e.length);let t=[];for(let i=0;i<e.length;i++){if(console.log("Type: "+e[i].type),"image/png"!==e[i].type&&"image/x-png"!==e[i].type&&"image/jpeg"!==e[i].type)continue;const a=window.URL.createObjectURL(e[i]);let s=this.uuidv4();console.log("uuid: "+s),t.push({id:s,imgDataUrl:a,file:e[i],selected:!1})}this.setState((e=>({images:[...e.images,...t]})))},this.loadImage=e=>new Promise(((t,i)=>{let a=new Image;a.onload=()=>{t(a)},a.onerror=e=>{i(e)},a.src=e})),this.fetchImage=async(e,t)=>{if(t){let i=await this.loadImage(e),a=document.createElement("canvas"),s=a.getContext("2d");a.width=i.width,a.height=i.height,s.drawImage(i,0,0,i.width,i.height);let n=await this.canvasToBlob(a,t);return{arrayBuffer:await n.arrayBuffer(),mime:"image/jpeg"}}{let t=await fetch(e);return{arrayBuffer:await t.arrayBuffer(),mime:t.headers.get("content-type")}}},this.createPdf=async()=>{let e="";try{this.setState({busy:!0});const a=await r.PDFDocument.create();for(let t=0;t<this.state.images.length;t++){let s=this.getPageSize(),n=await this.fetchImage(this.state.images[t].imgDataUrl,this.state.compressImages?this.state.imageQuality/10:void 0),l=await n.arrayBuffer;e=n.mime,console.log(e);let o=1;if("image/jpeg"===e)try{let e=c.a.readFromBinaryFile(l);e.Orientation&&(o=e.Orientation,console.log("jpegOrientation: "+o))}catch(i){console.error(i)}const d=await("image/jpeg"===e?a.embedJpg(l):a.embedPng(l));if(console.log("width: "+d.width+" height: "+d.height),this.state.pageSize===f)s=[d.width,d.height];else switch(o){case 6:case 8:s=[s[1],s[0]]}const g=a.addPage(s);if(this.state.pageSize===f)g.drawImage(d,{x:0,y:0,width:d.width,height:d.height});else{let e=Math.min((g.getWidth()-this.state.pageMargin)/d.width,(g.getHeight()-this.state.pageMargin)/d.height);d.width,d.height;console.log(d.width+" "+d.height),console.log(g.getWidth()+" "+g.getHeight());let t=d.scale(e);g.drawImage(d,{x:g.getWidth()/2-t.width/2,y:g.getHeight()/2-t.height/2,width:t.width,height:t.height})}switch(o){case 6:g.setRotation(Object(r.degrees)(90));break;case 3:g.setRotation(Object(r.degrees)(180));break;case 8:g.setRotation(Object(r.degrees)(270))}}const s=await a.save();let n=new Blob([s],{type:"application/pdf"});var t=document.createElement("a");t.href=window.URL.createObjectURL(n);t.download="file.pdf",t.click(),this.setState({busy:!1})}catch(a){console.error(a),this.setState({lastError:a,lastMime:e,busy:!1})}},this.deletePage=e=>{console.log("To delete: "+e);let t=[...this.state.images],i=-1;t.forEach(((t,a)=>{t.id===e&&(i=a)})),t.splice(i,1),this.setState({images:t})},this.handleDrop=(e,t)=>{console.log("droppedId: "+e+" currentId: "+t);let i=-1,a=[...this.state.images];a.forEach(((t,a)=>{t.id===e&&(i=a)}));let s=a.splice(i,1)[0],n=-1;a.forEach(((e,i)=>{e.id===t&&(n=i)})),a.splice(n,0,s),console.log(a),this.setState({images:a})},this.getPageSize=()=>{switch(this.state.pageSize){case h:if(this.state.pageOrientation===u)return r.PageSizes.A4;{let e=[...r.PageSizes.A4];return e.reverse(),e}case x:if(this.state.pageOrientation===u)return r.PageSizes.Letter;{let e=[...r.PageSizes.Letter];return e.reverse(),e}default:return}},this.getAspectRatio=()=>{let e=this.getPageSize();return e[0]/e[1]},this.state={images:[],pageOrientation:u,pageSize:h,pageMargin:b,lastError:void 0,lastMime:void 0,forceShowOption:!1,compressImages:!1,imageQuality:8,busy:!1},this.fileInput=s.a.createRef()}render(){let e={height:"192px",width:"192px",border:"none",display:"flex",background:"white",position:"relative"},t={margin:"0px",flex:"1",backgroundSize:"contain",backgroundRepeat:"no-repeat",backgroundPosition:"center"};this.state.pageMargin===y?t.margin="5px":this.state.pageMargin===m&&(t.margin="10px"),this.state.pageSize!==f&&(e.width=Math.ceil(192*this.getAspectRatio())+"px",e.boxShadow="5px 5px 5px rgb(200,200,200)");const i=Object(p.jsxs)("div",{className:"landing-page",children:[Object(p.jsxs)("div",{style:{padding:"40px"},children:["Convert JPEG or PNG images to PDF without uploading your sensitive data anywhere.",Object(p.jsx)("br",{}),"Files are processed entirely on your device and do not get uploaded to any server."]}),Object(p.jsx)("button",{onClick:()=>this.fileInput.current.click(),className:"big-btn",children:"Select Images"}),Object(p.jsx)("div",{className:"dropzone",onDragStart:e=>{},onDrop:e=>{e.stopPropagation&&e.stopPropagation(),e.preventDefault&&e.preventDefault();let t=e.dataTransfer.files;this.readfiles(t)},onDragOver:e=>{e.preventDefault&&e.preventDefault()},onDragEnter:e=>{e.preventDefault()},children:"or drop images here"}),Object(p.jsxs)("footer",{style:{textAlign:"center",paddingTop:"20px"},children:[Object(p.jsx)("p",{children:"This tool is completely free to use, but maintaining it is not easy."}),Object(p.jsx)("p",{children:"If you find this tool useful, please consider supporting us by making a donation."}),Object(p.jsx)("a",{href:"https://www.shaoyuyuan.com/yuan",target:"_blank",style:{backgroundColor:"#4CAF50",color:"white",padding:"10px 20px",textDecoration:"none",borderRadius:"5px"},children:"Donate"})]})]}),a=Object(p.jsx)("div",{style:{display:"flex",flexWrap:"wrap",flex:"1",justifyContent:"center"},children:this.state.images.map(((i,a)=>Object(p.jsx)("div",{style:{padding:"5px"},draggable:!0,onDragStart:e=>{e.dataTransfer.effectAllowed="move",e.dataTransfer.setData("text/plain",i.id),console.log("Drag start "+a)},onDrop:e=>{e.stopPropagation&&e.stopPropagation();let t=e.dataTransfer.getData("text/plain");console.log("droppedId: "+t),this.handleDrop(t,i.id)},onDragOver:e=>{e.preventDefault&&e.preventDefault()},onDragEnter:e=>{e.preventDefault()},children:Object(p.jsxs)("div",{style:{...e},onClick:e=>{let t=[...this.state.images];for(let a=0;a<t.length;a++)t[a]={...t[a],selected:t[a].id===i.id};this.setState({images:[...t]}),e.stopPropagation()},children:[Object(p.jsx)("div",{style:{display:i.selected?"block":"none",position:"absolute",right:"0px",top:"0px",padding:"5px",color:"rgb(180,180,180)"},onClick:e=>{e.stopPropagation(),this.deletePage(i.id)},children:Object(p.jsx)("i",{className:"fa fa-trash","aria-hidden":"true"})}),Object(p.jsx)("div",{style:{...t,backgroundImage:"url('"+i.imgDataUrl+"')"}})]})},i.id+"")))}),s=Object(p.jsxs)("div",{children:[Object(p.jsx)("div",{style:{paddingBottom:"10px",fontSize:"16px",color:"gray",paddingTop:"20px"},children:"Page margin"}),Object(p.jsxs)("div",{style:{display:"flex"},children:[Object(p.jsx)("div",{style:{flex:"1",height:"50px",display:"flex",flexDirection:"column",justifyContent:"center",textAlign:"center",background:this.state.pageMargin==b?"purple":"rgb(240,240,240)",color:this.state.pageMargin==b?"white":"black",padding:"5px"},onClick:()=>this.setState({pageMargin:b}),children:"None"}),Object(p.jsx)("div",{style:{flex:"1",height:"50px",display:"flex",flexDirection:"column",justifyContent:"center",textAlign:"center",background:this.state.pageMargin==y?"purple":"rgb(240,240,240)",color:this.state.pageMargin==y?"white":"black",padding:"5px"},onClick:()=>this.setState({pageMargin:y}),children:"Small"}),Object(p.jsx)("div",{style:{flex:"1",height:"50px",display:"flex",flexDirection:"column",justifyContent:"center",textAlign:"center",background:this.state.pageMargin==m?"purple":"rgb(240,240,240)",color:this.state.pageMargin==m?"white":"black",padding:"5px"},onClick:()=>this.setState({pageMargin:m}),children:"Big"})]})]}),n=Object(p.jsxs)("div",{style:{display:"flex",justifyContent:"space-between"},children:[Object(p.jsx)("div",{style:{display:"flex",flexDirection:"column",justifyContent:"center"},children:"Image quality"}),Object(p.jsxs)("div",{style:{display:"flex"},children:[Object(p.jsx)("div",{style:{padding:"5px"},children:Object(p.jsx)("button",{onClick:()=>{this.state.imageQuality<10&&this.setState({imageQuality:+this.state.imageQuality+1})},children:"+"})}),Object(p.jsx)("div",{style:{padding:"5px"},children:Object(p.jsx)("div",{children:this.state.imageQuality/10})}),Object(p.jsx)("div",{style:{padding:"5px"},children:Object(p.jsx)("button",{onClick:()=>{this.state.imageQuality>1&&this.setState({imageQuality:+this.state.imageQuality-1})},children:"-"})})]})]}),l={};this.state.forceShowOption&&(l.display="block");const r=this.state.forceShowOption?Object(p.jsx)("span",{onClick:()=>{this.setState({forceShowOption:!1})},children:"X"}):Object(p.jsx)("span",{}),o=Object(p.jsxs)("div",{className:"options",style:l,children:[Object(p.jsxs)("div",{style:{paddingBottom:"10px",fontSize:"20px",display:"flex",justifyContent:"space-between"},children:[Object(p.jsx)("span",{children:"Options"}),r]}),Object(p.jsx)("div",{style:{paddingBottom:"10px",fontSize:"16px",color:"gray",paddingTop:"10px"},children:"Page orientation"}),Object(p.jsxs)("div",{style:{display:"flex"},children:[Object(p.jsx)("div",{style:{flex:"1",height:"50px",display:"flex",flexDirection:"column",justifyContent:"center",textAlign:"center",background:this.state.pageOrientation==u?"purple":"rgb(240,240,240)",color:this.state.pageOrientation==u?"white":"black",padding:"5px"},onClick:()=>this.setState({pageOrientation:u}),children:"Portrait"}),Object(p.jsx)("div",{style:{flex:"1",height:"50px",display:"flex",flexDirection:"column",justifyContent:"center",textAlign:"center",background:this.state.pageOrientation==j?"purple":"rgb(240,240,240)",color:this.state.pageOrientation==j?"white":"black",padding:"5px"},onClick:()=>this.setState({pageOrientation:j}),children:"Landscape"})]}),Object(p.jsx)("div",{style:{paddingBottom:"10px",fontSize:"16px",color:"gray",paddingTop:"20px"},children:"Page size"}),Object(p.jsxs)("div",{style:{display:"flex"},children:[Object(p.jsx)("div",{style:{flex:"1",height:"50px",display:"flex",flexDirection:"column",justifyContent:"center",textAlign:"center",background:this.state.pageSize==h?"purple":"rgb(240,240,240)",color:this.state.pageSize==h?"white":"black",padding:"5px"},onClick:()=>this.setState({pageSize:h}),children:"A4"}),Object(p.jsx)("div",{style:{flex:"1",height:"50px",display:"flex",flexDirection:"column",justifyContent:"center",textAlign:"center",background:this.state.pageSize==x?"purple":"rgb(240,240,240)",color:this.state.pageSize==x?"white":"black",padding:"5px"},onClick:()=>this.setState({pageSize:x}),children:"US Letter"}),Object(p.jsx)("div",{style:{flex:"1",height:"50px",display:"flex",flexDirection:"column",justifyContent:"center",textAlign:"center",background:this.state.pageSize==f?"purple":"rgb(240,240,240)",color:this.state.pageSize==f?"white":"black",padding:"5px"},onClick:()=>this.setState({pageSize:f}),children:"Same as Image"})]}),this.state.pageSize!==f?s:Object(p.jsx)("div",{}),Object(p.jsx)("div",{style:{paddingBottom:"10px",fontSize:"16px",color:"gray",paddingTop:"20px"},children:"Compression"}),Object(p.jsxs)("div",{style:{display:"flex"},children:[Object(p.jsx)("div",{style:{flex:"1",height:"50px",display:"flex",flexDirection:"column",justifyContent:"center",textAlign:"center",background:this.state.compressImages?"purple":"rgb(240,240,240)",color:this.state.compressImages?"white":"black",padding:"5px"},onClick:()=>this.setState({compressImages:!0}),children:"Compress Images"}),Object(p.jsx)("div",{style:{flex:"1",height:"50px",display:"flex",flexDirection:"column",justifyContent:"center",textAlign:"center",background:this.state.compressImages?"rgb(240,240,240)":"purple",color:this.state.compressImages?"black":"white",padding:"5px"},onClick:()=>this.setState({compressImages:!1}),children:"Don't Compress"})]}),this.state.compressImages?n:Object(p.jsx)("div",{})]}),c=Object(p.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",padding:"10px",borderTop:"1px solid rgb(200,200,200)"},children:[Object(p.jsxs)("div",{style:{display:"flex"},children:[Object(p.jsx)("div",{style:{paddingLeft:"5px",paddingRight:"5px"},children:Object(p.jsx)("button",{onClick:()=>{this.setState({forceShowOption:!0})},className:"option-btn button",children:"PDF Options"})}),Object(p.jsx)("button",{onClick:()=>this.fileInput.current.click(),className:"button",children:"Add page"})]}),Object(p.jsx)("button",{onClick:this.createPdf,className:"button",children:"Generate PDF"})]}),d=Object(p.jsx)("div",{className:"page-header",children:Object(p.jsx)("span",{children:"CONVERT IMAGE TO PDF"})});if(this.state.images.length<1)return Object(p.jsxs)("div",{children:[d,Object(p.jsx)("input",{type:"file",ref:this.fileInput,onChange:()=>this.readfiles(this.fileInput.current.files),multiple:!0,style:{display:"none"}}),i]});const g={};return this.state.busy&&(g.display="flex"),Object(p.jsxs)("div",{style:{display:"flex",flexDirection:"column",width:"100%",height:"100%",overflow:"hidden",flex:"1"},children:[d,Object(p.jsxs)("div",{style:{display:"flex",overflow:"hidden",flex:"1"},children:[Object(p.jsxs)("div",{style:{display:"flex",flexDirection:"column",width:"100%",flex:"1",overflow:"auto",background:"rgb(240,240,240)"},onClick:this.clearSelection,children:[a,Object(p.jsx)("div",{style:{flex:"1"}})]}),o]}),c,Object(p.jsx)("input",{type:"file",accept:"image/*",ref:this.fileInput,onChange:()=>this.readfiles(this.fileInput.current.files),multiple:!0,style:{display:"none"}}),Object(p.jsx)("div",{className:"busy",style:g,children:"Generating PDF, Please wait..."})]})}readExif(e){c.a.readFromBinaryFile(e)}canvasToBlob(e,t){return new Promise(((i,a)=>{try{e.toBlob(i,"image/jpeg",t)}catch(s){a(s)}}))}uuidv4(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(e){let t=16*Math.random()|0;return("x"==e?t:3&t|8).toString(16)}))}}var v=O;var w=e=>{e&&e instanceof Function&&i.e(3).then(i.bind(null,62)).then((t=>{let{getCLS:i,getFID:a,getFCP:s,getLCP:n,getTTFB:l}=t;i(e),a(e),s(e),n(e),l(e)}))};i(60);l.a.render(Object(p.jsx)(s.a.StrictMode,{children:Object(p.jsx)(v,{})}),document.getElementById("root")),w()}},[[61,1,2]]]);
//# sourceMappingURL=main.ec3bdb64.chunk.js.map